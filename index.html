<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•©ê²©ì˜ ì‹  : ë‚˜ëŠ” ì–´ë””ë¡œ?</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap');
        
        body { font-family: 'Noto Sans KR', sans-serif; }
        .font-game { font-family: 'Jua', sans-serif; }
        
        /* Animations */
        .slide-in { animation: slideIn 0.6s cubic-bezier(0.22, 1, 0.36, 1); }
        .pop-in { animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .bounce-slow { animation: bounce 2s infinite; }
        .float { animation: float 3s ease-in-out infinite; }
        
        @keyframes slideIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes popIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-15px); } 100% { transform: translateY(0px); } }
        
        .university-card:hover { transform: translateY(-4px); box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.1); }
        .hidden-section { display: none !important; }
        
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .bg-pattern {
            background-image: radial-gradient(#e0e7ff 2px, transparent 2px);
            background-size: 24px 24px;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen flex flex-col bg-pattern">

    <!-- Header -->
    <header class="bg-white/80 backdrop-blur-md text-indigo-900 p-3 shadow-sm sticky top-0 z-50 border-b border-indigo-100">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center gap-2">
            <h1 class="text-xl md:text-2xl font-game flex items-center tracking-wider text-indigo-600 cursor-pointer hover:text-indigo-800 transition" onclick="location.reload()">
                <i class="fas fa-paper-plane mr-2 animate-bounce"></i>í•©ê²©ì˜ ì‹  v6.1
            </h1>
            <div id="status-bar" class="hidden text-xs md:text-sm flex flex-wrap justify-center gap-3 transition-all duration-300">
                <span class="bg-indigo-50 px-3 py-1 rounded-full border border-indigo-200 text-indigo-700 shadow-sm"><i class="fas fa-user mr-1"></i> <span id="display-name" class="font-bold">ìˆ˜í—˜ìƒ</span></span>
                <span class="bg-green-50 px-3 py-1 rounded-full border border-green-200 text-green-700 shadow-sm"><i class="fas fa-book-open mr-1"></i> ë‚´ì‹ : <span id="display-gpa" class="font-bold">0.00</span></span>
                <span class="bg-purple-50 px-3 py-1 rounded-full border border-purple-200 text-purple-700 shadow-sm"><i class="fas fa-chart-line mr-1"></i> ìˆ˜ëŠ¥: <span id="display-sat" class="font-bold">0</span>%</span>
                <span id="combo-badge" class="hidden bg-yellow-400 text-white px-3 py-1 rounded-full font-black border-2 border-orange-400 shadow-md transform scale-110 animate-pulse">0 COMBO!</span>
            </div>
        </div>
    </header>

    <main class="container mx-auto p-4 flex-grow relative flex flex-col justify-center items-center">
        
        <!-- Scene 1: Intro -->
        <section id="scene-intro" class="max-w-md w-full relative slide-in z-10 mt-4">
            <div class="absolute -top-16 -left-10 text-6xl text-yellow-300 float" style="animation-delay: 0s; z-index: -1;">âœ¨</div>
            <div class="absolute top-10 -right-12 text-5xl text-blue-200 float" style="animation-delay: 1s; z-index: -1;">â˜ï¸</div>
            <div class="absolute bottom-20 -left-8 text-4xl text-pink-300 float" style="animation-delay: 2s; z-index: -1;">ğŸŒ¸</div>

            <div class="bg-white p-8 rounded-[2.5rem] shadow-[0_20px_50px_rgba(8,_112,_184,_0.1)] border border-indigo-50 text-center relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-400 via-indigo-500 to-purple-500"></div>
                
                <div class="mb-6 relative inline-block group">
                     <div class="w-28 h-28 bg-gradient-to-br from-indigo-100 to-blue-50 rounded-full flex items-center justify-center mx-auto shadow-inner group-hover:scale-110 transition duration-500">
                        <i class="fas fa-graduation-cap text-5xl text-indigo-600 drop-shadow-sm"></i>
                    </div>
                    <span class="absolute -bottom-2 -right-2 text-3xl bg-white rounded-full p-1 shadow-md">ğŸ“</span>
                </div>

                <h1 class="text-4xl font-game text-slate-800 mb-2 tracking-tight">í•©ê²©ì˜ ì‹ </h1>
                <h2 class="text-xl font-game text-indigo-500 mb-6">: ë‚˜ëŠ” ì–´ë””ë¡œ ê°ˆê¹Œ? ğŸ¤”</h2>

                <form id="profile-form" class="space-y-5 text-left">
                    <div class="group">
                        <label class="block text-xs font-bold text-slate-400 mb-1 ml-2 uppercase tracking-wider">Player Name</label>
                        <input type="text" id="input-name" class="w-full bg-slate-50 border-2 border-slate-100 p-3.5 rounded-2xl focus:border-indigo-400 focus:bg-white focus:ring-4 focus:ring-indigo-100 outline-none font-bold text-center text-slate-700 transition-all placeholder:text-slate-300" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-xs font-bold text-slate-400 mb-1 ml-2">ë‚´ì‹  (1.0~9.0)</label>
                            <input type="number" id="input-gpa" step="0.1" min="1.0" max="9.0" class="w-full bg-slate-50 border-2 border-slate-100 p-3.5 rounded-2xl focus:border-green-400 focus:bg-white focus:ring-4 focus:ring-green-100 outline-none font-bold text-center text-slate-700 transition-all placeholder:text-slate-300" placeholder="3.5" required>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-400 mb-1 ml-2">ëª¨ì˜ê³ ì‚¬ (%)</label>
                            <input type="number" id="input-sat" min="0" max="100" class="w-full bg-slate-50 border-2 border-slate-100 p-3.5 rounded-2xl focus:border-purple-400 focus:bg-white focus:ring-4 focus:ring-purple-100 outline-none font-bold text-center text-slate-700 transition-all placeholder:text-slate-300" placeholder="85" required>
                        </div>
                    </div>
                    <button type="submit" class="w-full bg-gradient-to-r from-indigo-600 to-blue-600 hover:from-indigo-700 hover:to-blue-700 text-white font-black py-4 rounded-2xl shadow-lg shadow-indigo-200 transition-all active:scale-95 text-lg mt-4 flex justify-center items-center gap-2 group">
                        <span>ì…ì‹œ ë ˆì´ìŠ¤ ì‹œì‘</span> <i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
                    </button>
                </form>

                <div class="mt-8 pt-4 border-t border-slate-100 text-xs text-slate-400 font-medium">
                    Created by <span class="text-indigo-500 font-bold bg-indigo-50 px-2 py-1 rounded">ìœ ì›ì„ T</span>
                </div>
            </div>
        </section>

        <!-- Scene 2: Quiz -->
        <section id="scene-quiz" class="hidden-section max-w-2xl w-full mx-auto slide-in">
            <div class="bg-white rounded-3xl shadow-xl overflow-hidden border border-slate-100">
                <div class="bg-slate-800 p-6 text-white flex justify-between items-center relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full -mr-10 -mt-10"></div>
                    <div class="relative z-10">
                        <h3 class="font-bold text-xl font-game text-yellow-400"><i class="fas fa-bolt mr-2"></i>ë§‰íŒ ìŠ¤í¼íŠ¸!</h3>
                        <p class="text-xs text-slate-300 mt-1">ì—°ì† ì •ë‹µ ì‹œ ë“±ê¸‰ì´ ëŒ€í­ ìƒìŠ¹í•©ë‹ˆë‹¤.</p>
                    </div>
                    <span class="relative z-10 text-sm font-bold bg-white/20 backdrop-blur-sm px-4 py-1.5 rounded-full border border-white/10">Q <span id="current-round">1</span>/5</span>
                </div>
                
                <div class="p-8">
                    <div class="mb-8">
                        <span id="quiz-subject" class="inline-block bg-indigo-50 text-indigo-600 text-xs px-3 py-1 rounded-lg mb-3 font-bold uppercase tracking-wide border border-indigo-100">Subject</span>
                        <h2 id="quiz-question" class="text-2xl font-bold text-slate-800 leading-snug break-keep">ë¬¸ì œ ë¡œë”©ì¤‘...</h2>
                    </div>
                    <div id="quiz-options" class="grid grid-cols-1 gap-3"></div>
                </div>
                
                <div id="quiz-feedback" class="hidden bg-slate-50 p-8 border-t text-center pop-in">
                    <div id="feedback-icon" class="text-5xl mb-4 inline-block"></div>
                    <p id="feedback-text" class="font-bold text-xl mb-6 text-slate-700"></p>
                    <button id="next-quiz-btn" class="bg-slate-800 text-white px-10 py-3 rounded-xl hover:bg-slate-900 font-bold shadow-lg transition transform hover:scale-105">ë‹¤ìŒ ë¬¸ì œ <i class="fas fa-chevron-right ml-1"></i></button>
                </div>
            </div>
        </section>

        <!-- Scene 3: Susi Application -->
        <section id="scene-susi" class="hidden-section slide-in w-full max-w-6xl">
            <div class="text-center mb-8">
                <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-xs font-bold mb-2 inline-block">STEP 1</span>
                <h2 class="text-3xl font-black text-slate-800 font-game">ìˆ˜ì‹œ ì›ì„œ ì ‘ìˆ˜ (ìµœëŒ€ 6ì¥)</h2>
                <p class="text-slate-500 mt-2">ìµœì¢… ë‚´ì‹ : <span class="font-bold text-blue-600 text-xl final-gpa-display bg-white px-3 py-1 rounded-lg shadow-sm border border-blue-100"></span></p>
                <p class="text-xs text-red-400 mt-1">* 1ì¥ë§Œ ì§€ì›í•´ë„ ì ‘ìˆ˜ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
            </div>

            <div class="flex flex-col lg:flex-row gap-6 h-[600px]">
                <!-- University List -->
                <div class="lg:w-2/3 flex flex-col h-full bg-white rounded-3xl shadow-lg p-6 border border-slate-100">
                    <div class="flex gap-2 mb-4 overflow-x-auto pb-2 flex-shrink-0 scrollbar-hide">
                        <button class="filter-btn active bg-slate-800 text-white px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap transition" data-filter="all">ì „ì²´ë³´ê¸°</button>
                        <button class="filter-btn bg-slate-100 text-slate-500 px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap hover:bg-slate-200 transition" data-filter="sky">ìµœìƒìœ„ê¶Œ</button>
                        <button class="filter-btn bg-slate-100 text-slate-500 px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap hover:bg-slate-200 transition" data-filter="in_seoul_top">ì¸ì„œìš¸ ì£¼ìš”</button>
                        <button class="filter-btn bg-slate-100 text-slate-500 px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap hover:bg-slate-200 transition" data-filter="in_seoul_mid">ìˆ˜ë„ê¶Œ/ì¸ì„œìš¸</button>
                        <button class="filter-btn bg-slate-100 text-slate-500 px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap hover:bg-slate-200 transition" data-filter="jigeoguk">ì§€ê±°êµ­/êµ­ë¦½</button>
                    </div>
                    <div id="susi-uni-list" class="grid grid-cols-1 md:grid-cols-2 gap-3 overflow-y-auto pr-2 pb-2"></div>
                </div>

                <!-- Cart -->
                <div class="lg:w-1/3 flex flex-col h-full bg-white rounded-3xl shadow-lg p-6 border-2 border-indigo-100 relative">
                    <div class="absolute -top-3 -right-3 bg-red-500 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold shadow-md z-10" id="susi-badge">0</div>
                    <div class="flex justify-between items-center mb-4 pb-4 border-b border-slate-100">
                        <h3 class="font-bold text-xl text-slate-800 font-game">ë‚´ ì›ì„œí•¨</h3>
                        <span class="text-indigo-600 font-black"><span id="susi-count">0</span>/6</span>
                    </div>
                    <div class="flex-grow overflow-y-auto bg-slate-50 rounded-2xl p-3 mb-4 inner-shadow">
                        <ul id="susi-cart" class="space-y-2 text-sm">
                            <li class="text-center py-20 text-slate-400 text-sm flex flex-col items-center opacity-70">
                                <i class="fas fa-inbox text-4xl mb-3 text-slate-300"></i>
                                ëŒ€í•™ì„ ì„ íƒí•˜ì—¬ ë‹´ì•„ì£¼ì„¸ìš”.
                            </li>
                        </ul>
                    </div>
                    <button id="btn-susi-submit" class="w-full bg-slate-200 text-slate-400 font-bold py-4 rounded-2xl transition-all duration-200 cursor-not-allowed shadow-none" disabled>
                        ì§€ì› ëŒ€í•™ì„ ì„ íƒí•˜ì„¸ìš”
                    </button>
                </div>
            </div>
        </section>

        <!-- Scene 4: Exam Intro -->
        <section id="scene-exam-intro" class="hidden-section max-w-lg mx-auto slide-in mt-10 w-full text-center">
            <div class="bg-white p-10 rounded-[2.5rem] shadow-2xl border-4 border-indigo-100 relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-3 bg-indigo-500"></div>
                <i class="fas fa-file-signature text-7xl text-indigo-500 mb-8 bounce-slow block"></i>
                <h2 class="text-3xl font-black text-slate-800 font-game mb-4">ëŒ€í•™ë³„ ê³ ì‚¬ ì‹¤ì‹œ</h2>
                <p class="text-slate-500 text-lg mb-8 leading-relaxed">ì§€ì›í•˜ì‹  ì „í˜•ì— ë”°ë¼<br><span class="text-indigo-600 font-bold">ë©´ì ‘ ë° ë…¼ìˆ  ê³ ì‚¬</span>ê°€ ì§„í–‰ë©ë‹ˆë‹¤.<br>(êµê³¼ ì „í˜•ì€ ê³ ì‚¬ ì—†ì´ ë°”ë¡œ ê²°ê³¼ê°€ ë‚˜ì˜µë‹ˆë‹¤)</p>
                <button onclick="startActualExams()" class="bg-indigo-600 text-white px-10 py-4 rounded-2xl font-bold hover:bg-indigo-700 shadow-lg shadow-indigo-200 transform hover:translate-y-[-2px] transition text-lg flex items-center justify-center gap-2 mx-auto">
                    ê³ ì‚¬ì¥ ì…ì¥ <i class="fas fa-door-open"></i>
                </button>
            </div>
        </section>

        <!-- Scene 4-1: Interview Game -->
        <section id="scene-interview" class="hidden-section max-w-2xl mx-auto slide-in mt-10 w-full">
            <div class="bg-white rounded-3xl shadow-2xl p-8 border-4 border-green-100">
                <div class="text-center mb-8">
                    <span class="bg-green-100 text-green-700 px-4 py-1.5 rounded-full text-sm font-bold mb-3 inline-block">í•™ìƒë¶€ì¢…í•©ì „í˜•</span>
                    <h3 class="text-3xl font-bold text-slate-800 font-game">ì‹¬ì¸µ ë©´ì ‘</h3>
                </div>
                <div id="interview-content" class="bg-slate-50 p-8 rounded-2xl border border-slate-200"></div>
            </div>
        </section>

        <!-- Scene 4-2: Essay Game -->
        <section id="scene-essay" class="hidden-section max-w-2xl mx-auto slide-in mt-10 w-full">
            <div class="bg-white rounded-3xl shadow-2xl p-8 border-4 border-purple-100">
                <div class="text-center mb-8">
                    <span class="bg-purple-100 text-purple-700 px-4 py-1.5 rounded-full text-sm font-bold mb-3 inline-block">ë…¼ìˆ ì „í˜•</span>
                    <h3 class="text-3xl font-bold text-slate-800 font-game">ë…¼ìˆ  ê³ ì‚¬</h3>
                </div>
                <div id="essay-content" class="bg-slate-50 p-8 rounded-2xl border border-slate-200"></div>
            </div>
        </section>

        <!-- Scene 5: Susi Result -->
        <section id="scene-susi-result" class="hidden-section max-w-6xl mx-auto slide-in w-full">
            <div class="bg-white rounded-3xl shadow-xl p-10 text-center min-h-[600px] flex flex-col justify-center relative">
                <h2 class="text-3xl font-black mb-2 text-slate-800 font-game">ìˆ˜ì‹œ í•©ê²©ì ë°œí‘œ</h2>
                <div id="susi-result-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 mb-10 mt-10"></div>
                
                <div id="susi-outcome-controls" class="hidden border-t border-slate-100 pt-10">
                    <div id="susi-pass-msg" class="hidden">
                        <div class="inline-block bg-green-100 p-4 rounded-full mb-4"><i class="fas fa-check text-4xl text-green-600"></i></div>
                        <p class="text-3xl font-bold text-green-600 mb-2 font-game">ì¶•í•˜í•©ë‹ˆë‹¤! ìˆ˜ì‹œ í•©ê²©!</p>
                        <p class="text-red-500 text-sm mb-8 font-bold bg-red-50 inline-block px-4 py-2 rounded-lg mt-2">â€» ìˆ˜ì‹œ í•©ê²©ì(ìµœì´ˆ/ì¶©ì›)ëŠ” ì •ì‹œ ì§€ì›ì´ ë²•ì ìœ¼ë¡œ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
                        <br>
                        <button id="end-game-susi" class="bg-slate-800 hover:bg-black text-white font-bold py-4 px-12 rounded-2xl shadow-xl font-game text-lg transition hover:scale-105">
                            ìµœì¢… í•©ê²©ì¦ ë°œê¸‰ë°›ê¸° ğŸ“œ
                        </button>
                    </div>
                    <div id="susi-fail-msg" class="hidden">
                        <div class="inline-block bg-slate-100 p-4 rounded-full mb-4"><i class="fas fa-times text-4xl text-slate-400"></i></div>
                        <p class="text-2xl font-bold text-slate-700 mb-2 font-game">ìˆ˜ì‹œ ì „í˜• ë¶ˆí•©ê²©</p>
                        <p class="text-blue-600 text-lg mb-8 font-medium">í•˜ì§€ë§Œ ì•„ì§ <span class="font-bold">ì •ì‹œ(ìˆ˜ëŠ¥)</span> ê¸°íšŒê°€ ë‚¨ì•˜ìŠµë‹ˆë‹¤!</p>
                        <button id="go-to-jeongsi" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-12 rounded-2xl shadow-xl font-game text-lg transition hover:scale-105">
                            ì •ì‹œ ì§€ì›í•˜ëŸ¬ ê°€ê¸° <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Scene 6: Jeongsi Application -->
        <section id="scene-jeongsi" class="hidden-section slide-in w-full max-w-6xl">
            <div class="text-center mb-8">
                <span class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full text-xs font-bold mb-2 inline-block">STEP 2</span>
                <h2 class="text-3xl font-black text-indigo-900 font-game">ì •ì‹œ ì›ì„œ ì ‘ìˆ˜ (ê°€/ë‚˜/ë‹¤êµ°)</h2>
                <p class="text-slate-500 mt-2">ìµœì¢… ìˆ˜ëŠ¥: <span class="font-bold text-purple-600 text-xl final-sat-display bg-white px-3 py-1 rounded-lg shadow-sm border border-purple-100"></span>%</p>
            </div>

            <div class="flex flex-col lg:flex-row gap-6 h-[600px]">
                <div class="lg:w-2/3 flex flex-col h-full bg-white rounded-3xl shadow-lg p-6 overflow-hidden border border-slate-100">
                    <div class="flex gap-2 mb-4 overflow-x-auto pb-2 flex-shrink-0 scrollbar-hide">
                        <button class="j-filter-btn active bg-indigo-600 text-white px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap transition" data-filter="all">ì „ì²´ë³´ê¸°</button>
                        <button class="j-filter-btn bg-slate-100 text-slate-500 px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap hover:bg-slate-200 transition" data-filter="sky">ìµœìƒìœ„</button>
                        <button class="j-filter-btn bg-slate-100 text-slate-500 px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap hover:bg-slate-200 transition" data-filter="in_seoul_top">ì¸ì„œìš¸ìƒ</button>
                        <button class="j-filter-btn bg-slate-100 text-slate-500 px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap hover:bg-slate-200 transition" data-filter="in_seoul_mid">ì¸ì„œìš¸ì¤‘/ìˆ˜ë„ê¶Œ</button>
                        <button class="j-filter-btn bg-slate-100 text-slate-500 px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap hover:bg-slate-200 transition" data-filter="jigeoguk">ì§€ê±°êµ­</button>
                    </div>
                    <div id="jeongsi-uni-list" class="grid grid-cols-1 md:grid-cols-2 gap-3 overflow-y-auto pr-2 pb-2 h-full"></div>
                </div>

                <div class="lg:w-1/3 flex flex-col h-full bg-white rounded-3xl shadow-lg p-6 border-2 border-indigo-100 relative">
                     <div class="absolute -top-3 -right-3 bg-purple-500 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold shadow-md z-10" id="jeongsi-badge">0</div>
                     <div class="flex justify-between items-center mb-4 pb-4 border-b border-slate-100">
                        <h3 class="font-bold text-xl text-slate-800 font-game">ì •ì‹œ ì›ì„œí•¨</h3>
                        <span class="text-indigo-600 font-black"><span id="jeongsi-count">0</span>/3</span>
                    </div>
                    <div class="flex-grow overflow-y-auto bg-slate-50 rounded-2xl p-3 mb-4 inner-shadow">
                        <ul id="jeongsi-cart" class="space-y-2 text-sm">
                            <li class="text-center py-20 text-slate-400 text-sm flex flex-col items-center opacity-70">
                                <i class="fas fa-clipboard-list text-4xl mb-3 text-slate-300"></i>
                                ëŒ€í•™ì„ ì„ íƒí•˜ì„¸ìš”.
                            </li>
                        </ul>
                    </div>
                    <button id="submit-jeongsi" disabled class="w-full bg-slate-200 text-slate-400 font-bold py-4 rounded-2xl transition-all shadow-none cursor-not-allowed text-lg">
                        ì›ì„œ ì ‘ìˆ˜í•˜ê¸°
                    </button>
                </div>
            </div>
        </section>

        <!-- Scene 7: Jeongsi Result Announcement -->
        <section id="scene-jeongsi-announce" class="hidden-section max-w-3xl mx-auto slide-in text-center mt-10 w-full">
            <div class="bg-white p-12 rounded-[2.5rem] shadow-2xl border-4 border-indigo-100">
                <h2 class="text-3xl font-black text-slate-800 font-game mb-8">ì •ì‹œ í•©ê²©ì ë°œí‘œ</h2>
                <!-- Loading Spinner with Correct ID -->
                <div class="flex justify-center mb-10" id="jeongsi-loading">
                    <div class="relative w-24 h-24">
                        <div class="absolute top-0 left-0 w-full h-full border-4 border-indigo-100 rounded-full"></div>
                        <div class="absolute top-0 left-0 w-full h-full border-4 border-indigo-600 rounded-full border-t-transparent animate-spin"></div>
                    </div>
                </div>
                <p class="text-slate-500 text-xl mb-10 font-medium">ì§€ì›í•˜ì‹  ëŒ€í•™ì˜ ê²°ê³¼ë¥¼ ì¡°íšŒ ì¤‘ì…ë‹ˆë‹¤...</p>
                <div id="jeongsi-results-container" class="grid gap-4 opacity-0 transition-opacity duration-1000"></div>
                <button id="go-to-final-from-jeongsi" class="hidden mt-10 bg-indigo-600 text-white px-10 py-4 rounded-2xl font-bold hover:bg-indigo-700 shadow-xl transition transform hover:scale-105 text-lg">
                    ìµœì¢… ê²°ê³¼ í™•ì¸ <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>
        </section>

        <!-- Scene 8: Final Result -->
        <section id="scene-final" class="hidden-section max-w-3xl mx-auto slide-in text-center mt-10 w-full">
            <div class="bg-white p-10 rounded-[2.5rem] shadow-2xl border-4 border-double border-yellow-300 relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-3 bg-gradient-to-r from-yellow-400 via-orange-400 to-red-400"></div>
                <i class="fas fa-crown text-7xl text-yellow-400 mb-6 drop-shadow-md mt-4 block bounce-slow"></i>
                <h2 class="text-4xl font-black text-slate-800 mb-4 font-game">ìµœì¢… í•©ê²© í˜„í™©</h2>
                <p class="text-slate-500 mb-8">ë‹¹ì‹ ì˜ 2026í•™ë…„ë„ ì…ì‹œ ê²°ê³¼ì…ë‹ˆë‹¤.</p>
                
                <div id="final-accepted-list" class="space-y-3 mb-10"></div>

                <div class="bg-slate-50 p-6 rounded-2xl text-left border border-slate-100 shadow-inner">
                    <h3 class="font-bold text-slate-700 mb-4 border-b border-slate-200 pb-2 text-sm uppercase tracking-wider"><i class="fas fa-file-invoice mr-2"></i>ìµœì¢… ì„±ì í‘œ</h3>
                    <div class="grid grid-cols-2 gap-6 text-sm">
                        <div><span class="text-slate-400 block text-xs mb-1">ìˆ˜í—˜ìƒ</span> <span class="font-bold final-name text-lg text-slate-800"></span></div>
                        <div><span class="text-slate-400 block text-xs mb-1">ì¶œì‹ ê³ êµ</span> <span class="font-bold text-slate-800">ìº”ë²„ìŠ¤ê³ ë“±í•™êµ</span></div>
                        <div><span class="text-slate-400 block text-xs mb-1">ìµœì¢… ë‚´ì‹ </span> <span class="font-bold text-blue-600 text-lg final-gpa-display"></span></div>
                        <div><span class="text-slate-400 block text-xs mb-1">ìˆ˜ëŠ¥ ë°±ë¶„ìœ„</span> <span class="font-bold text-purple-600 text-lg final-sat-display"></span>%</div>
                    </div>
                </div>

                <button onclick="location.reload()" class="mt-10 bg-slate-800 text-white px-10 py-4 rounded-2xl hover:bg-black shadow-xl font-bold transition transform hover:scale-105 mb-4 group">
                    <i class="fas fa-redo mr-2 group-hover:rotate-180 transition-transform duration-500"></i>ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°
                </button>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-slate-100 text-slate-400 text-center p-4 text-xs">
        <p>Copyright â“’ 2026 <span class="font-bold text-indigo-500">ìœ ì›ì„ T</span>. All rights reserved.</p>
    </footer>
    
    <!-- Susi Type Modal -->
    <div id="type-modal" class="fixed inset-0 bg-black/60 hidden z-[60] flex items-center justify-center p-4 backdrop-blur-sm transition-opacity">
        <div class="bg-white rounded-3xl shadow-2xl max-w-sm w-full p-8 transform scale-100 transition-transform">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-3">
                    <i class="fas fa-stamp text-2xl text-blue-500"></i>
                </div>
                <h3 class="text-2xl font-bold text-slate-800 font-game">ì „í˜• ì„ íƒ</h3>
                <p class="text-sm text-slate-500 mt-1" id="modal-uni-name">ëŒ€í•™êµ</p>
            </div>
            
            <div class="space-y-3">
                <button class="type-select-btn w-full p-4 border-2 border-slate-100 rounded-2xl hover:border-blue-500 hover:bg-blue-50 transition text-left flex items-center justify-between group bg-white" data-type="êµê³¼">
                    <div>
                        <div class="font-bold text-slate-700 group-hover:text-blue-600">í•™ìƒë¶€ êµê³¼</div>
                        <div class="text-xs text-slate-400 mt-0.5">ë‚´ì‹  100% (ì •ëŸ‰í‰ê°€)</div>
                    </div>
                    <i class="fas fa-calculator text-slate-300 group-hover:text-blue-500 text-xl"></i>
                </button>
                <button class="type-select-btn w-full p-4 border-2 border-slate-100 rounded-2xl hover:border-green-500 hover:bg-green-50 transition text-left flex items-center justify-between group bg-white" data-type="ì¢…í•©">
                    <div>
                        <div class="font-bold text-slate-700 group-hover:text-green-600">í•™ìƒë¶€ ì¢…í•©</div>
                        <div class="text-xs text-slate-400 mt-0.5">ì„œë¥˜ + ì‹¬ì¸µ ë©´ì ‘</div>
                    </div>
                    <i class="fas fa-user-tie text-slate-300 group-hover:text-green-500 text-xl"></i>
                </button>
                <button class="type-select-btn w-full p-4 border-2 border-slate-100 rounded-2xl hover:border-purple-500 hover:bg-purple-50 transition text-left flex items-center justify-between group bg-white" data-type="ë…¼ìˆ ">
                    <div>
                        <div class="font-bold text-slate-700 group-hover:text-purple-600">ë…¼ìˆ  ì „í˜•</div>
                        <div class="text-xs text-slate-400 mt-0.5">ë‚´ì‹ â†“ + ê³ ë‚œë„ ë…¼ìˆ </div>
                    </div>
                    <i class="fas fa-pen-nib text-slate-300 group-hover:text-purple-500 text-xl"></i>
                </button>
            </div>
            <button onclick="closeModal()" class="mt-6 w-full py-3 text-slate-400 hover:text-slate-600 font-bold transition">ë‹«ê¸°</button>
        </div>
    </div>

    <script>
        // --- University Data (50 Universities) ---
        const universities = [
            // SKY
            { id: 1, name: "ì„œìš¸ëŒ€í•™êµ", tier: "sky", susi_cut: 1.15, jeongsi_cut: 99.0, logo: "fas fa-university", color: "text-blue-900" },
            { id: 2, name: "ì—°ì„¸ëŒ€í•™êµ", tier: "sky", susi_cut: 1.45, jeongsi_cut: 97.5, logo: "fas fa-eagle", color: "text-blue-700" },
            { id: 3, name: "ê³ ë ¤ëŒ€í•™êµ", tier: "sky", susi_cut: 1.55, jeongsi_cut: 97.0, logo: "fas fa-shield-cat", color: "text-red-800" },
            // In Seoul Top
            { id: 4, name: "ì„œê°•ëŒ€í•™êµ", tier: "in_seoul_top", susi_cut: 1.65, jeongsi_cut: 94.5, logo: "fas fa-star", color: "text-red-600" },
            { id: 5, name: "ì„±ê· ê´€ëŒ€í•™êµ", tier: "in_seoul_top", susi_cut: 1.70, jeongsi_cut: 95.0, logo: "fas fa-leaf", color: "text-green-700" },
            { id: 6, name: "í•œì–‘ëŒ€í•™êµ", tier: "in_seoul_top", susi_cut: 1.75, jeongsi_cut: 94.0, logo: "fas fa-lion", color: "text-blue-600" },
            { id: 7, name: "ì¤‘ì•™ëŒ€í•™êµ", tier: "in_seoul_top", susi_cut: 1.85, jeongsi_cut: 93.0, logo: "fas fa-building-columns", color: "text-blue-500" },
            { id: 8, name: "ê²½í¬ëŒ€í•™êµ", tier: "in_seoul_top", susi_cut: 1.95, jeongsi_cut: 92.0, logo: "fas fa-globe", color: "text-red-500" },
            { id: 9, name: "í•œêµ­ì™¸êµ­ì–´ëŒ€", tier: "in_seoul_top", susi_cut: 2.10, jeongsi_cut: 91.0, logo: "fas fa-earth-asia", color: "text-cyan-700" },
            { id: 10, name: "ì„œìš¸ì‹œë¦½ëŒ€", tier: "in_seoul_top", susi_cut: 2.15, jeongsi_cut: 91.5, logo: "fas fa-city", color: "text-blue-900" },
            { id: 11, name: "ì´í™”ì—¬ìëŒ€", tier: "in_seoul_top", susi_cut: 1.90, jeongsi_cut: 92.5, logo: "fas fa-flower", color: "text-green-800" },
            // In Seoul Mid / Capital
            { id: 12, name: "ê±´êµ­ëŒ€í•™êµ", tier: "in_seoul_mid", susi_cut: 2.20, jeongsi_cut: 90.0, logo: "fas fa-horse-head", color: "text-green-600" },
            { id: 13, name: "ë™êµ­ëŒ€í•™êµ", tier: "in_seoul_mid", susi_cut: 2.30, jeongsi_cut: 89.0, logo: "fas fa-dharmachakra", color: "text-orange-600" },
            { id: 14, name: "í™ìµëŒ€í•™êµ", tier: "in_seoul_mid", susi_cut: 2.40, jeongsi_cut: 88.0, logo: "fas fa-palette", color: "text-blue-800" },
            { id: 15, name: "ìˆ™ëª…ì—¬ìëŒ€", tier: "in_seoul_mid", susi_cut: 2.35, jeongsi_cut: 88.5, logo: "fas fa-snowflake", color: "text-blue-400" },
            { id: 16, name: "êµ­ë¯¼ëŒ€í•™êµ", tier: "in_seoul_mid", susi_cut: 2.60, jeongsi_cut: 86.0, logo: "fas fa-tree", color: "text-green-800" },
            { id: 17, name: "ìˆ­ì‹¤ëŒ€í•™êµ", tier: "in_seoul_mid", susi_cut: 2.65, jeongsi_cut: 86.5, logo: "fas fa-church", color: "text-blue-500" },
            { id: 18, name: "ì„¸ì¢…ëŒ€í•™êµ", tier: "in_seoul_mid", susi_cut: 2.70, jeongsi_cut: 85.5, logo: "fas fa-chess-king", color: "text-red-700" },
            { id: 19, name: "ë‹¨êµ­ëŒ€í•™êµ", tier: "in_seoul_mid", susi_cut: 2.80, jeongsi_cut: 84.0, logo: "fas fa-bear", color: "text-blue-900" },
            { id: 20, name: "ì„œìš¸ê³¼ê¸°ëŒ€", tier: "in_seoul_mid", susi_cut: 2.50, jeongsi_cut: 85.0, logo: "fas fa-microchip", color: "text-black" },
            { id: 21, name: "ê´‘ìš´ëŒ€í•™êµ", tier: "in_seoul_mid", susi_cut: 2.90, jeongsi_cut: 83.0, logo: "fas fa-bolt", color: "text-red-600" },
            { id: 22, name: "ëª…ì§€ëŒ€í•™êµ", tier: "in_seoul_mid", susi_cut: 3.00, jeongsi_cut: 82.0, logo: "fas fa-tree", color: "text-blue-800" },
            { id: 23, name: "ìƒëª…ëŒ€í•™êµ", tier: "in_seoul_mid", susi_cut: 3.10, jeongsi_cut: 81.0, logo: "fas fa-leaf", color: "text-green-600" },
            { id: 24, name: "ê°€í†¨ë¦­ëŒ€", tier: "in_seoul_mid", susi_cut: 3.20, jeongsi_cut: 80.0, logo: "fas fa-cross", color: "text-blue-500" },
            { id: 25, name: "ì¸í•˜ëŒ€í•™êµ", tier: "in_seoul_mid", susi_cut: 2.85, jeongsi_cut: 82.0, logo: "fas fa-plane", color: "text-blue-600" },
            { id: 26, name: "ì•„ì£¼ëŒ€í•™êµ", tier: "in_seoul_mid", susi_cut: 2.75, jeongsi_cut: 83.0, logo: "fas fa-user-md", color: "text-blue-900" },
            { id: 27, name: "ì¸ì²œëŒ€í•™êµ", tier: "in_seoul_mid", susi_cut: 3.15, jeongsi_cut: 79.0, logo: "fas fa-anchor", color: "text-blue-400" },
            { id: 28, name: "ê°€ì²œëŒ€í•™êµ", tier: "in_seoul_mid", susi_cut: 3.25, jeongsi_cut: 80.0, logo: "fas fa-wind", color: "text-blue-500" },
            { id: 29, name: "ê²½ê¸°ëŒ€í•™êµ", tier: "in_seoul_mid", susi_cut: 3.40, jeongsi_cut: 78.0, logo: "fas fa-road", color: "text-blue-500" },
            // Jigeoguk
            { id: 30, name: "ë¶€ì‚°ëŒ€í•™êµ", tier: "jigeoguk", susi_cut: 3.0, jeongsi_cut: 83.0, logo: "fas fa-mountain", color: "text-blue-700" },
            { id: 31, name: "ê²½ë¶ëŒ€í•™êµ", tier: "jigeoguk", susi_cut: 3.1, jeongsi_cut: 82.5, logo: "fas fa-apple-alt", color: "text-red-700" },
            { id: 32, name: "ì „ë‚¨ëŒ€í•™êµ", tier: "jigeoguk", susi_cut: 3.5, jeongsi_cut: 76.0, logo: "fas fa-tree", color: "text-green-700" },
            { id: 33, name: "ì¶©ë‚¨ëŒ€í•™êµ", tier: "jigeoguk", susi_cut: 3.4, jeongsi_cut: 77.0, logo: "fas fa-horse", color: "text-blue-800" },
            { id: 34, name: "ì¶©ë¶ëŒ€í•™êµ", tier: "jigeoguk", susi_cut: 3.7, jeongsi_cut: 74.0, logo: "fas fa-bullseye", color: "text-red-800" },
            { id: 35, name: "ì „ë¶ëŒ€í•™êµ", tier: "jigeoguk", susi_cut: 3.8, jeongsi_cut: 73.0, logo: "fas fa-book", color: "text-purple-700" },
            { id: 36, name: "ê°•ì›ëŒ€í•™êµ", tier: "jigeoguk", susi_cut: 4.0, jeongsi_cut: 70.0, logo: "fas fa-mountain", color: "text-green-600" },
            { id: 37, name: "ì œì£¼ëŒ€í•™êµ", tier: "jigeoguk", susi_cut: 4.5, jeongsi_cut: 67.0, logo: "fas fa-island-tropical", color: "text-orange-500" },
            { id: 38, name: "ê²½ìƒêµ­ë¦½ëŒ€", tier: "jigeoguk", susi_cut: 4.2, jeongsi_cut: 69.0, logo: "fas fa-plane-departure", color: "text-blue-500" },
            { id: 39, name: "ë¶€ê²½ëŒ€í•™êµ", tier: "jigeoguk", susi_cut: 3.6, jeongsi_cut: 75.0, logo: "fas fa-fish", color: "text-blue-400" },
            // Local
            { id: 40, name: "ìš¸ì‚°ëŒ€í•™êµ", tier: "local", susi_cut: 4.4, jeongsi_cut: 66.0, logo: "fas fa-ship", color: "text-teal-600" },
            { id: 41, name: "ì˜ë‚¨ëŒ€í•™êµ", tier: "local", susi_cut: 4.6, jeongsi_cut: 64.0, logo: "fas fa-seedling", color: "text-green-500" },
            { id: 42, name: "ë™ì•„ëŒ€í•™êµ", tier: "local", susi_cut: 4.8, jeongsi_cut: 62.0, logo: "fas fa-book-open", color: "text-indigo-600" },
            { id: 43, name: "ê³„ëª…ëŒ€í•™êµ", tier: "local", susi_cut: 5.0, jeongsi_cut: 60.0, logo: "fas fa-music", color: "text-blue-700" },
            { id: 44, name: "ì¡°ì„ ëŒ€í•™êµ", tier: "local", susi_cut: 5.2, jeongsi_cut: 58.0, logo: "fas fa-sun", color: "text-orange-600" },
            { id: 45, name: "ì›ê´‘ëŒ€í•™êµ", tier: "local", susi_cut: 5.5, jeongsi_cut: 55.0, logo: "fas fa-circle", color: "text-green-400" },
            { id: 46, name: "ëŒ€êµ¬ëŒ€í•™êµ", tier: "local", susi_cut: 5.7, jeongsi_cut: 52.0, logo: "fas fa-wheelchair", color: "text-green-600" },
            { id: 47, name: "ìš¸ì‚°ê³¼í•™ëŒ€", tier: "local", susi_cut: 5.3, jeongsi_cut: 56.0, logo: "fas fa-flask", color: "text-purple-600" },
            { id: 48, name: "í•œë‚¨ëŒ€í•™êµ", tier: "local", susi_cut: 5.4, jeongsi_cut: 54.0, logo: "fas fa-bridge", color: "text-blue-400" },
            { id: 49, name: "ìˆœì²œí–¥ëŒ€", tier: "local", susi_cut: 4.3, jeongsi_cut: 68.0, logo: "fas fa-hospital", color: "text-green-500" }
        ];

        // --- Expanded Quiz Data (30 Questions) ---
        const quizPool = [
            // êµ­ì–´
            { subject: "êµ­ì–´(ë¬¸í•™)", q: "ê¹€ì†Œì›”ì˜ ì‹œ 'ì§„ë‹¬ë˜ê½ƒ'ì˜ ì£¼ëœ ì •ì„œëŠ”?", options: ["ì´ë³„ì˜ ì •í•œ", "ë‚˜ë¼ ìƒì€ ìŠ¬í””", "ìì—° ì¹œí™”", "í˜„ì‹¤ ë¹„íŒ"], a: 0 },
            { subject: "êµ­ì–´(ë¬¸ë²•)", q: "ë‹¤ìŒ ì¤‘ í‘œì¤€ì–´ì¸ ê²ƒì€?", options: ["ì§œì¥ë©´", "ë§¨ë‚ ", "í—ˆì ‘ì“°ë ˆê¸°", "ëª¨ë‘ ì •ë‹µ"], a: 3 },
            { subject: "êµ­ì–´(ë¹„ë¬¸í•™)", q: "ê¸€ì˜ ë…¼ì§€ ì „ê°œ ë°©ì‹ ì¤‘ 'ìœ ì¶”'ë€?", options: ["ë°˜ëŒ€ ì‚¬ë¡€ ì œì‹œ", "ë¹„ìŠ·í•œ ì†ì„±ìœ¼ë¡œ ì„¤ëª…", "ì „ë¬¸ê°€ ê²¬í•´ ì¸ìš©", "í†µê³„ ìë£Œ ì œì‹œ"], a: 1 },
            { subject: "êµ­ì–´(ê³ ì „)", q: "ê´€ë™ë³„ê³¡ì˜ ì‘ê°€ëŠ”?", options: ["ì •ì² ", "ì†¡ìˆœ", "ìœ¤ì„ ë„", "í™©ì§„ì´"], a: 0 },
            // ìˆ˜í•™
            { subject: "ìˆ˜í•™(í™•ë¥ )", q: "ì£¼ì‚¬ìœ„ 1ê°œë¥¼ ë˜ì ¸ ì§ìˆ˜ê°€ ë‚˜ì˜¬ í™•ë¥ ì€?", options: ["1/2", "1/3", "1/4", "1/6"], a: 0 },
            { subject: "ìˆ˜í•™(ë¯¸ë¶„)", q: "f(x)=xÂ²ì˜ ë„í•¨ìˆ˜ëŠ”?", options: ["x", "2x", "xÂ²", "2"], a: 1 },
            { subject: "ìˆ˜í•™(ì§‘í•©)", q: "ì›ì†Œê°€ í•˜ë‚˜ë„ ì—†ëŠ” ì§‘í•©ì€?", options: ["ì „ì²´ì§‘í•©", "ë¶€ë¶„ì§‘í•©", "ê³µì§‘í•©", "ì—¬ì§‘í•©"], a: 2 },
            { subject: "ìˆ˜í•™(ê¸°í•˜)", q: "íƒ€ì›ì˜ ì •ì˜ì™€ ê´€ë ¨ ìˆëŠ” ê²ƒì€?", options: ["ë‘ ì´ˆì  ê±°ë¦¬ì˜ í•©", "ë‘ ì´ˆì  ê±°ë¦¬ì˜ ì°¨", "í•œ ì ê³¼ ì§ì„ ì˜ ê±°ë¦¬", "ì¤‘ì‹¬ê³¼ ë°˜ì§€ë¦„"], a: 0 },
            // ì˜ì–´
            { subject: "ì˜ì–´(ì–´íœ˜)", q: "'Benevolent'ì˜ ëœ»ìœ¼ë¡œ ì ì ˆí•œ ê²ƒì€?", options: ["ìì• ë¡œìš´", "ì ëŒ€ì ì¸", "ê²Œìœ¼ë¥¸", "ìœ ìµí•œ"], a: 0 },
            { subject: "ì˜ì–´(ì†ë‹´)", q: "'It rains cats and dogs'ì˜ ì˜ë¯¸ëŠ”?", options: ["ë¹„ê°€ ì–µìˆ˜ê°™ì´ ì˜¨ë‹¤", "ê°œì™€ ê³ ì–‘ì´ê°€ ì‹¸ìš´ë‹¤", "ë‚ ì”¨ê°€ ë§‘ë‹¤", "ë™ë¬¼ì„ ì‚¬ë‘í•œë‹¤"], a: 0 },
            { subject: "ì˜ì–´(ë¬¸ë²•)", q: "ê°€ì •ë²• ê³¼ê±°ì™„ë£Œì˜ í˜•íƒœëŠ”?", options: ["If+S+had pp", "If+S+came", "If+S+will come", "If+S+have pp"], a: 0 },
            { subject: "ì˜ì–´(ë…í•´)", q: "'Ubiquitous'ì˜ ëœ»ì€?", options: ["ì–´ë””ì—ë‚˜ ìˆëŠ”", "í¬ê·€í•œ", "ìœ„í—˜í•œ", "ë§›ìˆëŠ”"], a: 0 },
            // ì‚¬íšŒ/ì—­ì‚¬
            { subject: "ì‚¬íšŒ(ê²½ì œ)", q: "ê¸°íšŒë¹„ìš©ì´ë€?", options: ["ê°€ì¥ ì‹¼ ë¹„ìš©", "í¬ê¸°í•œ ê²ƒ ì¤‘ ìµœì„ ì˜ ê°€ì¹˜", "ìƒì‚°ì— ë“œëŠ” ì´ ë¹„ìš©"], a: 1 },
            { subject: "í•œêµ­ì‚¬", q: "ì„¸ì¢…ëŒ€ì™•ì´ ì°½ì œí•œ ë¬¸ìëŠ”?", options: ["ì´ë‘", "í›ˆë¯¼ì •ìŒ", "ê°€ë¦¼í† ", "ì‹ ë¼ì–´"], a: 1 },
            { subject: "ìƒí™œê³¼ìœ¤ë¦¬", q: "ê³µë¦¬ì£¼ì˜ê°€ ì¶”êµ¬í•˜ëŠ” ê²ƒì€?", options: ["ìµœëŒ€ ë‹¤ìˆ˜ì˜ ìµœëŒ€ í–‰ë³µ", "ì˜ë¬´ì˜ ì´í–‰", "ë•ì˜ ì‹¤í˜„", "ë¬´ìœ„ìì—°"], a: 0 },
            { subject: "í•œêµ­ì§€ë¦¬", q: "ìš°ë¦¬ë‚˜ë¼ì˜ í‘œì¤€ì‹œëŠ” ë™ê²½ ëª‡ ë„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•˜ëŠ”ê°€?", options: ["127.5ë„", "135ë„", "124ë„", "132ë„"], a: 1 },
            { subject: "ì„¸ê³„ì‚¬", q: "í”„ë‘ìŠ¤ í˜ëª…ì´ ì¼ì–´ë‚œ í•´ëŠ”?", options: ["1789ë…„", "1894ë…„", "1919ë…„", "1492ë…„"], a: 0 },
            // ê³¼í•™
            { subject: "ê³¼í•™(ë¬¼ë¦¬)", q: "F=maëŠ” ëˆ„êµ¬ì˜ ë²•ì¹™ì¸ê°€?", options: ["ì•„ì¸ìŠˆíƒ€ì¸", "ë‰´í„´", "ê°ˆë¦´ë ˆì´"], a: 1 },
            { subject: "ì§€êµ¬ê³¼í•™", q: "ì§€êµ¬ì˜ ìì „ ë°©í–¥ì€?", options: ["ë™ì—ì„œ ì„œë¡œ", "ì„œì—ì„œ ë™ìœ¼ë¡œ", "ë‚¨ì—ì„œ ë¶ìœ¼ë¡œ"], a: 1 },
            { subject: "ê³¼í•™(í™”í•™)", q: "ê°€ì¥ ê°€ë²¼ìš´ ì›ì†ŒëŠ”?", options: ["í—¬ë¥¨", "ìˆ˜ì†Œ", "ë¦¬íŠ¬", "ì§ˆì†Œ"], a: 1 },
            { subject: "ìƒëª…ê³¼í•™", q: "DNAì˜ ì—¼ê¸° ì„œì—´ì´ ì•„ë‹Œ ê²ƒì€?", options: ["ì•„ë°ë‹Œ(A)", "êµ¬ì•„ë‹Œ(G)", "ìš°ë¼ì‹¤(U)", "í‹°ë¯¼(T)"], a: 2 }, // RNA has Uracil
            { subject: "ê³¼í•™(ë¬¼ë¦¬)", q: "ê´€ì„±ì˜ ë²•ì¹™ì€ ë‰´í„´ì˜ ëª‡ ë²•ì¹™ì¸ê°€?", options: ["ì œ1ë²•ì¹™", "ì œ2ë²•ì¹™", "ì œ3ë²•ì¹™", "ë§Œìœ ì¸ë ¥"], a: 0 },
            // ì‹œì‚¬/ìƒì‹
            { subject: "ì‹œì‚¬", q: "OECDì˜ ë³¸ë¶€ê°€ ìˆëŠ” ë„ì‹œëŠ”?", options: ["ë‰´ìš•", "íŒŒë¦¬", "ì œë„¤ë°”", "ëŸ°ë˜"], a: 1 },
            { subject: "ì •ë³´", q: "ì»´í“¨í„°ì˜ ë‘ë‡Œì— í•´ë‹¹í•˜ëŠ” ë¶€í’ˆì€?", options: ["RAM", "HDD", "CPU", "GPU"], a: 2 },
            { subject: "ìƒì‹", q: "ìœ ë„¤ìŠ¤ì½” ì„¸ê³„ìœ ì‚°ì´ ì•„ë‹Œ ê²ƒì€?", options: ["ë¶ˆêµ­ì‚¬", "ì„êµ´ì•”", "ë‚¨ëŒ€ë¬¸(ìˆ­ë¡€ë¬¸)", "í•´ì¸ì‚¬ ì¥ê²½íŒì „"], a: 2 }, // ìˆ­ë¡€ë¬¸ì€ êµ­ë³´ì§€ë§Œ ìœ ë„¤ìŠ¤ì½” ì„¸ê³„ìœ ì‚° ëª©ë¡ ì•„ë‹˜ (ê¸°ë¡ìœ ì‚° ë“± ì œì™¸)
            { subject: "ê²½ì œ", q: "'ë³´ì´ì§€ ì•ŠëŠ” ì†'ì„ ì£¼ì¥í•œ í•™ìëŠ”?", options: ["ì¼€ì¸ì¦ˆ", "ì• ë¤ ìŠ¤ë¯¸ìŠ¤", "ë§ˆë¥´í¬ìŠ¤", "ë¦¬ì¹´ë„"], a: 1 }
        ];

        // --- Interview & Nonsul Questions ---
        const interviewQuestions = [
            { type: "ë™ê¸°", q: "ìš°ë¦¬ í•™ê³¼ì— ì§€ì›í•˜ê²Œ ëœ ê²°ì •ì ì¸ ê³„ê¸°ëŠ” ë¬´ì—‡ì¸ê°€ìš”?", options: ["ì„±ì ì— ë§ì¶°ì„œ ì§€ì›í–ˆìŠµë‹ˆë‹¤.", "ë¶€ëª¨ë‹˜ì˜ ê¶Œìœ ë¡œ ì§€ì›í–ˆìŠµë‹ˆë‹¤.", "ê³ êµ ì‹œì ˆ ê´€ë ¨ ë™ì•„ë¦¬ í™œë™ì„ í•˜ë©° ì‹¬ë„ ìˆëŠ” ê´€ì‹¬ì„ ê°–ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.", "ì·¨ì—… ì „ë§ì´ ë°ì•„ì„œ ì„ íƒí–ˆìŠµë‹ˆë‹¤."], a: 2 },
            { type: "ê²½í—˜", q: "ê³ ë“±í•™êµ ìƒí™œ ì¤‘ ê°€ì¥ í˜ë“¤ì—ˆë˜ ê²½í—˜ê³¼ ê·¹ë³µ ê³¼ì •ì€?", options: ["ìˆ˜í•™ ì ìˆ˜ê°€ ì•ˆ ë‚˜ì™€ì„œ í¬ê¸°í–ˆìŠµë‹ˆë‹¤.", "ì¹œêµ¬ì™€ ë‹¤í‰œì§€ë§Œ ë¨¼ì € ì‚¬ê³¼í•˜ê³  í™”í•´í•˜ë©° ì†Œí†µì˜ ì¤‘ìš”ì„±ì„ ë°°ì› ìŠµë‹ˆë‹¤.", "ë™ì•„ë¦¬ íšŒì¥ì— ë–¨ì–´ì ¸ì„œ ì•„ë¬´ê²ƒë„ ì•ˆ í–ˆìŠµë‹ˆë‹¤.", "ê¸‰ì‹ì´ ë§›ì—†ì–´ì„œ ë§¤ì ì„ ì• ìš©í–ˆìŠµë‹ˆë‹¤."], a: 1 },
            { type: "ì¸ì„±", q: "ì¡°ë³„ ê³¼ì œ ì¤‘ ë¬´ì„ìŠ¹ì°¨í•˜ëŠ” íŒ€ì›ì´ ìˆë‹¤ë©´ ì–´ë–»ê²Œ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?", options: ["ê·¸ëƒ¥ ì œê°€ ë‹¤ í•˜ê³  ë§™ë‹ˆë‹¤.", "êµìˆ˜ë‹˜ê»˜ ë°”ë¡œ ì´ë¦…ë‹ˆë‹¤.", "ì§€ì†ì ìœ¼ë¡œ ëŒ€í™”í•˜ë©° ì—­í• ì„ ë¶„ë‹´í•˜ê³  ì°¸ì—¬ë¥¼ ë…ë ¤í•˜ê² ìŠµë‹ˆë‹¤.", "ê·¸ ì¹œêµ¬ ì´ë¦„ì„ ë¹¼ë²„ë¦½ë‹ˆë‹¤."], a: 2 },
            { type: "ì‹œì‚¬", q: "ìµœê·¼ AI ê¸°ìˆ (ChatGPT ë“±)ì˜ ë°œì „ì´ ì‚¬íšŒì— ë¯¸ì¹  ì˜í–¥ì€?", options: ["ë³„ ê´€ì‹¬ ì—†ìŠµë‹ˆë‹¤.", "ì¼ìë¦¬ê°€ ì¤„ì–´ë“¤ì–´ ì•ˆ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.", "ë‹¨ìˆœ ì—…ë¬´ íš¨ìœ¨í™”ë¿ ì•„ë‹ˆë¼ ì°½ì˜ì  ì˜ì—­ê¹Œì§€ í™•ì¥ë˜ì–´ ìœ¤ë¦¬ì  ë…¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤.", "ìˆ™ì œí•  ë•Œ í¸í•´ì„œ ì¢‹ìŠµë‹ˆë‹¤."], a: 2 }
        ];
        
        const nonsulQuestions = [
            { type: "ì¸ë¬¸", q: "[ì¸ë¬¸ë…¼ìˆ ] 'ê³µë¦¬ì£¼ì˜'ì™€ 'ì˜ë¬´ë¡ 'ì˜ ê´€ì ì—ì„œ ì‚¬í˜• ì œë„ë¥¼ ë…¼í•˜ì‹œì˜¤.", options: ["ë‘ ê´€ì  ëª¨ë‘ ì‚¬í˜• ì œë„ë¥¼ ë¬´ì¡°ê±´ ë°˜ëŒ€í•œë‹¤.", "ê³µë¦¬ì£¼ì˜ëŠ” ë²”ì£„ ì˜ˆë°© íš¨ê³¼ë¥¼, ì˜ë¬´ë¡ ì€ ì‘ë³´ì  ì •ì˜ë¥¼ ê°•ì¡°í•  ìˆ˜ ìˆë‹¤.", "ìƒê´€ì—†ëŠ” ì£¼ì œì´ë‹¤."], a: 1 },
            { type: "ìˆ˜ë¦¬", q: "[ìˆ˜ë¦¬ë…¼ìˆ ] í•¨ìˆ˜ f(x)=x^3-3x^2+a ì˜ ê·¹ì†Ÿê°’ì´ 1ì¼ ë•Œ, ìƒìˆ˜ aì˜ ê°’ì€?", options: ["3", "5", "7"], a: 1 }, 
            { type: "ê²½ì œ", q: "[ìƒê²½ë…¼ìˆ ] ì‹œì¥ì˜ ì‹¤íŒ¨(Market Failure) ì›ì¸ì´ ì•„ë‹Œ ê²ƒì€?", options: ["ë…ê³¼ì ", "ê³µê³µì¬ì˜ ì¡´ì¬", "ì™¸ë¶€íš¨ê³¼", "ì™„ì „ ê²½ìŸ ì‹œì¥"], a: 3 }
        ];

        // Game State
        let player = { name: "", gpa: 0, sat: 0 };
        let currentQuizQueue = [];
        let currentRound = 0;
        let consecutiveCorrect = 0;
        let susiCart = [];
        let jeongsiCart = [];
        let finalResults = [];
        let selectedUniForModal = null;
        let jonghapScore = 0;
        let nonsulScore = 0;

        // --- Functions ---
        function updateStatus() {
            document.getElementById('display-name').innerText = player.name;
            document.getElementById('display-gpa').innerText = player.gpa.toFixed(2);
            document.getElementById('display-sat').innerText = player.sat;
            const badge = document.getElementById('combo-badge');
            if(consecutiveCorrect > 1) {
                badge.classList.remove('hidden');
                badge.innerText = `ğŸ”¥ ${consecutiveCorrect} COMBO!`;
            } else {
                badge.classList.add('hidden');
            }
            document.getElementById('susi-badge').innerText = susiCart.length;
            document.getElementById('jeongsi-badge').innerText = jeongsiCart.length;
        }
        function switchScene(id) {
            document.querySelectorAll('section').forEach(s => s.classList.add('hidden-section'));
            const target = document.getElementById(id);
            target.classList.remove('hidden-section');
            target.classList.add('slide-in');
            window.scrollTo(0,0);
        }

        // Start
        document.getElementById('profile-form').addEventListener('submit', (e) => {
            e.preventDefault();
            player.name = document.getElementById('input-name').value;
            player.gpa = parseFloat(document.getElementById('input-gpa').value);
            player.sat = parseInt(document.getElementById('input-sat').value);
            document.getElementById('status-bar').classList.remove('hidden');
            document.getElementById('status-bar').classList.add('flex');
            updateStatus();
            
            // Pick 5 random questions
            currentQuizQueue = [...quizPool].sort(()=>0.5-Math.random()).slice(0,5);
            switchScene('scene-quiz');
            loadQuiz();
        });

        // Quiz
        function loadQuiz() {
            if(currentRound >= 5) { setTimeout(startSusi, 800); return; }
            document.getElementById('current-round').innerText = currentRound+1;
            document.getElementById('quiz-feedback').classList.add('hidden');
            
            const q = currentQuizQueue[currentRound];
            document.getElementById('quiz-subject').innerText = q.subject;
            document.getElementById('quiz-question').innerText = q.q;
            const opts = document.getElementById('quiz-options');
            opts.innerHTML = '';
            q.options.forEach((o, i) => {
                const btn = document.createElement('button');
                btn.className = "w-full text-left p-4 rounded-2xl border-2 border-slate-100 hover:border-indigo-500 hover:bg-indigo-50 font-bold text-slate-600 transition active:scale-95";
                btn.innerHTML = `<span class="bg-indigo-100 text-indigo-700 px-2 py-1 rounded mr-2 text-xs">${i+1}</span> ${o}`;
                btn.onclick = () => checkAnswer(i, q.a);
                opts.appendChild(btn);
            });
        }
        function checkAnswer(sel, ans) {
            const fb = document.getElementById('quiz-feedback');
            fb.classList.remove('hidden');
            document.querySelectorAll('#quiz-options button').forEach(b=>b.disabled=true);
            
            if(sel===ans) {
                consecutiveCorrect++;
                const gpaBoost = 0.15 + (consecutiveCorrect-1)*0.1;
                const satBoost = 2 + (consecutiveCorrect-1)*2;
                player.gpa = Math.max(1.0, player.gpa - gpaBoost);
                player.sat = Math.min(100, player.sat + satBoost);
                document.getElementById('feedback-icon').innerHTML = "ğŸ‰";
                document.getElementById('feedback-text').innerHTML = `ì •ë‹µì…ë‹ˆë‹¤! <br><span class='text-green-600 text-sm'>ë‚´ì‹  -${gpaBoost.toFixed(2)} / ìˆ˜ëŠ¥ +${satBoost}ì </span>`;
            } else {
                consecutiveCorrect = 0;
                player.gpa = Math.min(9.0, player.gpa + 0.1);
                player.sat = Math.max(0, player.sat - 2);
                document.getElementById('feedback-icon').innerHTML = "ğŸ˜­";
                document.getElementById('feedback-text').innerHTML = `ì˜¤ë‹µì…ë‹ˆë‹¤.. <br><span class='text-red-500 text-sm'>ë‚´ì‹  +0.1 / ìˆ˜ëŠ¥ -2ì </span>`;
            }
            updateStatus();
        }
        document.getElementById('next-quiz-btn').onclick = () => { currentRound++; loadQuiz(); };

        // Susi Logic
        function startSusi() {
            switchScene('scene-susi');
            document.querySelectorAll('.final-gpa-display').forEach(e=>e.innerText = player.gpa.toFixed(2));
            renderSusiList('all');
            
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.onclick = (e) => {
                    document.querySelectorAll('.filter-btn').forEach(b => {
                        b.classList.remove('bg-slate-800','text-white','active');
                        b.classList.add('bg-slate-100','text-slate-500');
                    });
                    e.target.classList.remove('bg-slate-100','text-slate-500');
                    e.target.classList.add('bg-slate-800','text-white','active');
                    renderSusiList(e.target.dataset.filter);
                };
            });
        }
        
        function renderSusiList(filter) {
            const list = document.getElementById('susi-uni-list');
            list.innerHTML = '';
            universities.forEach(u => {
                if(filter !== 'all') {
                    if (filter === 'sky' && u.tier !== 'sky') return;
                    if (filter === 'in_seoul_top' && u.tier !== 'in_seoul_top') return;
                    if (filter === 'in_seoul_mid' && u.tier !== 'in_seoul_mid') return;
                    if (filter === 'jigeoguk' && u.tier !== 'jigeoguk') return;
                    if (filter === 'local' && u.tier !== 'local') return;
                }

                const diff = player.gpa - u.susi_cut;
                let badge = "";
                let badgeClass = "";
                if(diff <= -0.3) { badge = "ì•ˆì •"; badgeClass = "bg-green-100 text-green-700"; }
                else if(diff <= 0.2) { badge = "ì ì •"; badgeClass = "bg-blue-100 text-blue-700"; }
                else { badge = "ìƒí–¥"; badgeClass = "bg-red-100 text-red-700"; }

                const d = document.createElement('div');
                d.className = "university-card bg-white border border-slate-100 p-4 rounded-2xl flex justify-between items-center cursor-pointer transition-all";
                d.innerHTML = `
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-slate-50 rounded-full flex items-center justify-center text-xl ${u.color} shadow-sm border border-slate-100"><i class="${u.logo}"></i></div>
                        <div>
                            <div class="font-bold text-slate-800">${u.name}</div>
                            <div class="flex items-center gap-2 mt-1">
                                <span class="text-[10px] ${badgeClass} px-2 py-0.5 rounded-full font-bold">${badge}</span>
                                <span class="text-xs text-slate-400">ì»· ${u.susi_cut}</span>
                            </div>
                        </div>
                    </div>
                    <button class="add-btn w-9 h-9 rounded-full bg-indigo-50 text-indigo-600 hover:bg-indigo-600 hover:text-white flex items-center justify-center transition"><i class="fas fa-plus"></i></button>
                `;
                d.querySelector('.add-btn').onclick = () => openTypeModal(u);
                list.appendChild(d);
            });
        }

        // Susi Modal & Cart
        function openTypeModal(u) {
            if(susiCart.length >= 6) { alert("ìˆ˜ì‹œ ì›ì„œëŠ” ìµœëŒ€ 6ì¥ì…ë‹ˆë‹¤."); return; }
            if(susiCart.find(x=>x.id===u.id)) { alert("ì´ë¯¸ ë‹´ì€ ëŒ€í•™ì…ë‹ˆë‹¤."); return; }
            selectedUniForModal = u;
            document.getElementById('modal-uni-name').innerText = u.name;
            document.getElementById('type-modal').classList.remove('hidden');
        }
        function closeModal() { document.getElementById('type-modal').classList.add('hidden'); selectedUniForModal=null; }
        document.querySelectorAll('.type-select-btn').forEach(b => {
            b.onclick = () => { if(selectedUniForModal) { susiCart.push({...selectedUniForModal, type: b.dataset.type}); updateSusiCart(); closeModal(); } };
        });

        function updateSusiCart() {
            const list = document.getElementById('susi-cart');
            const cnt = document.getElementById('susi-count');
            const btn = document.getElementById('btn-susi-submit');
            cnt.innerText = susiCart.length;
            list.innerHTML = '';
            
            updateStatus(); 

            if(susiCart.length === 0) {
                list.innerHTML = '<li class="text-center py-20 text-slate-400 text-sm flex flex-col items-center opacity-70"><i class="fas fa-inbox text-4xl mb-3 text-slate-300"></i>ëŒ€í•™ì„ ì„ íƒí•˜ì—¬ ë‹´ì•„ì£¼ì„¸ìš”.</li>';
                btn.disabled = true; 
                btn.className = "w-full bg-slate-200 text-slate-400 font-bold py-4 rounded-2xl transition-all duration-200 cursor-not-allowed shadow-none";
                btn.innerText = "ëŒ€í•™ì„ ì„ íƒí•˜ì„¸ìš”";
            } else {
                susiCart.forEach((u, i) => {
                    let typeClass = u.type==='êµê³¼'?'bg-blue-100 text-blue-700':(u.type==='ì¢…í•©'?'bg-green-100 text-green-700':'bg-purple-100 text-purple-700');
                    const li = document.createElement('li');
                    li.className = "flex justify-between items-center p-3 bg-white border border-slate-100 rounded-xl text-sm pop-in shadow-sm";
                    li.innerHTML = `
                        <div class="flex items-center gap-2">
                            <span class="text-[10px] font-bold px-2 py-0.5 rounded ${typeClass}">${u.type}</span>
                            <span class="font-bold text-slate-700">${u.name}</span>
                        </div>
                        <button onclick="susiCart.splice(${i},1);updateSusiCart()" class="text-slate-300 hover:text-red-500 transition"><i class="fas fa-times"></i></button>
                    `;
                    list.appendChild(li);
                });
                // Allow submit if > 0
                btn.disabled = false; 
                btn.className = "w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-2xl shadow-lg transition-all active:scale-95";
                btn.innerText = `ìˆ˜ì‹œ ì›ì„œ ${susiCart.length}ì¥ ì ‘ìˆ˜í•˜ê¸°`;
            }
        }

        document.getElementById('btn-susi-submit').onclick = () => {
            const hasJonghap = susiCart.some(u=>u.type==='ì¢…í•©');
            const hasNonsul = susiCart.some(u=>u.type==='ë…¼ìˆ ');
            if(!hasJonghap && !hasNonsul) processSusiResults();
            else switchScene('scene-exam-intro');
        };

        window.startActualExams = function() {
            if(susiCart.some(u=>u.type==='ì¢…í•©')) setupInterview(susiCart.some(u=>u.type==='ë…¼ìˆ '));
            else if(susiCart.some(u=>u.type==='ë…¼ìˆ ')) setupEssay();
            else processSusiResults();
        }

        // Exams
        function setupInterview(hasNext) {
            switchScene('scene-interview');
            const q = interviewQuestions[Math.floor(Math.random()*interviewQuestions.length)];
            let typeBadge = "";
            if(q.type === 'ë™ê¸°') typeBadge = '<span class="bg-blue-100 text-blue-700 px-2 py-0.5 rounded text-xs font-bold mb-2 inline-block">ì§€ì›ë™ê¸°</span>';
            if(q.type === 'ê²½í—˜') typeBadge = '<span class="bg-orange-100 text-orange-700 px-2 py-0.5 rounded text-xs font-bold mb-2 inline-block">í•™êµìƒí™œ</span>';
            if(q.type === 'ì¸ì„±') typeBadge = '<span class="bg-green-100 text-green-700 px-2 py-0.5 rounded text-xs font-bold mb-2 inline-block">ì¸ì„±/ê°€ì¹˜ê´€</span>';
            if(q.type === 'ì‹œì‚¬') typeBadge = '<span class="bg-purple-100 text-purple-700 px-2 py-0.5 rounded text-xs font-bold mb-2 inline-block">ì‹œì‚¬/ìƒì‹</span>';

            document.getElementById('interview-content').innerHTML = `
                <div class="mb-6">${typeBadge}<p class="font-bold text-xl text-slate-800 leading-relaxed">"${q.q}"</p></div>
                <div class="grid gap-3">${q.options.map((o,i)=>`<button onclick="finishInterview(${i},${q.a},${hasNext})" class="w-full text-left p-4 bg-white border-2 border-slate-100 rounded-xl hover:border-green-500 hover:bg-green-50 transition font-medium text-slate-600">${i+1}. ${o}</button>`).join('')}</div>
            `;
        }
        window.finishInterview = (s, a, next) => {
            if(s===a) { jonghapScore = 0.5; alert("ë©´ì ‘ê´€ì´ ë§¤ìš° í¡ì¡±í•´í•©ë‹ˆë‹¤! (+ê°€ì‚°ì )"); }
            else { jonghapScore = -0.3; alert("ë©´ì ‘ê´€ì˜ í‘œì •ì´ ë¯¸ë¬˜í•©ë‹ˆë‹¤.. (-ê°ì )"); }
            if(next) setupEssay(); else processSusiResults();
        };

        function setupEssay() {
            switchScene('scene-essay');
            const q = nonsulQuestions[Math.floor(Math.random()*nonsulQuestions.length)];
            let typeBadge = "";
            if(q.type === 'ì¸ë¬¸') typeBadge = '<span class="bg-pink-100 text-pink-700 px-2 py-0.5 rounded text-xs font-bold mb-2 inline-block">ì¸ë¬¸ë…¼ìˆ </span>';
            if(q.type === 'ìˆ˜ë¦¬') typeBadge = '<span class="bg-blue-100 text-blue-700 px-2 py-0.5 rounded text-xs font-bold mb-2 inline-block">ìˆ˜ë¦¬ë…¼ìˆ </span>';
            if(q.type === 'ê²½ì œ') typeBadge = '<span class="bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded text-xs font-bold mb-2 inline-block">ìƒê²½ë…¼ìˆ </span>';

            document.getElementById('essay-content').innerHTML = `
                <div class="mb-6">${typeBadge}<p class="font-bold text-xl text-slate-800 leading-relaxed">${q.q}</p></div>
                <div class="grid gap-3">${q.options.map((o,i)=>`<button onclick="finishEssay(${i},${q.a})" class="w-full text-left p-4 bg-white border-2 border-slate-100 rounded-xl hover:border-purple-500 hover:bg-purple-50 transition font-medium text-slate-600">${i+1}. ${o}</button>`).join('')}</div>
            `;
        }
        window.finishEssay = (s, a) => {
            if(s===a) { nonsulScore = 1.5; alert("ì™„ë²½í•œ ë‹µì•ˆì…ë‹ˆë‹¤! (+ëŒ€í­ ê°€ì‚°ì )"); }
            else { nonsulScore = -0.5; alert("ë…¼ì ì„ ë²—ì–´ë‚œ ë‹µì•ˆì…ë‹ˆë‹¤.. (-ê°ì )"); }
            processSusiResults();
        };

        // Susi Result Logic (UPDATED Strict Gyogwa)
        function processSusiResults() {
            switchScene('scene-susi-result');
            const list = document.getElementById('susi-result-list');
            list.innerHTML = '';
            let passedCount = 0;
            susiCart.forEach((u, i) => {
                setTimeout(() => {
                    let passed = false;
                    
                    if (u.type === 'êµê³¼') {
                        // Strict Cut Logic
                        const diff = player.gpa - u.susi_cut; // e.g., 3.0 - 1.5 = +1.5 (Bad)
                        if (diff > 0.1) {
                            // If GPA is worse than cut by more than 0.1, FAIL.
                            passed = false;
                        } else if (diff <= -0.2) {
                            // If GPA is better by 0.2 or more, PASS High Prob
                            passed = Math.random() < 0.95;
                        } else {
                            // Borderline
                            passed = Math.random() < 0.5;
                        }
                    } else {
                        // Jonghap / Nonsul (Existing Logic)
                        let cut = u.susi_cut;
                        if(u.type==='ì¢…í•©') cut += (0.3 + jonghapScore);
                        if(u.type==='ë…¼ìˆ ') cut += (1.0 + nonsulScore);
                        const diff = cut - player.gpa;
                        let prob = (diff>0.5)?95:(diff>0)?70:(diff>-0.3)?30:5;
                        passed = Math.random()*100 < prob;
                    }

                    if(passed) passedCount++;
                    finalResults.push({name:u.name, type:`ìˆ˜ì‹œ(${u.type})`, status:passed?'í•©ê²©':'ë¶ˆí•©ê²©'});
                    
                    const d = document.createElement('div');
                    d.className = "bg-white border border-slate-100 rounded-2xl p-6 shadow-md flex flex-col items-center justify-center pop-in";
                    d.innerHTML = `
                        <div class="text-xs text-slate-400 font-bold mb-1">${u.type}</div>
                        <div class="font-bold text-lg mb-2">${u.name}</div>
                        <div class="text-xl font-black ${passed?'text-green-600':'text-slate-300'}">${passed?'ğŸ‰ í•©ê²©':'ë¶ˆí•©ê²©'}</div>
                    `;
                    list.appendChild(d);

                    if(i === susiCart.length-1) {
                        document.getElementById('susi-outcome-controls').classList.remove('hidden');
                        if(passedCount>0) document.getElementById('susi-pass-msg').classList.remove('hidden');
                        else document.getElementById('susi-fail-msg').classList.remove('hidden');
                    }
                }, i*600);
            });
        }

        // Jeongsi Logic
        document.getElementById('go-to-jeongsi').onclick = startJeongsi;
        document.getElementById('end-game-susi').onclick = showFinal;

        function startJeongsi() {
            switchScene('scene-jeongsi');
            document.querySelectorAll('.final-sat-display').forEach(e=>e.innerText = player.sat);
            renderJeongsiList('all');
            document.querySelectorAll('.j-filter-btn').forEach(btn => {
                btn.onclick = (e) => {
                    document.querySelectorAll('.j-filter-btn').forEach(b => {
                        b.classList.remove('bg-indigo-600','text-white','active');
                        b.classList.add('bg-slate-100','text-slate-500');
                    });
                    e.target.classList.remove('bg-slate-100','text-slate-500');
                    e.target.classList.add('bg-indigo-600','text-white','active');
                    renderJeongsiList(e.target.dataset.filter);
                };
            });
        }

        function renderJeongsiList(filter) {
            const list = document.getElementById('jeongsi-uni-list');
            list.innerHTML = '';
            universities.forEach(u => {
                if(filter !== 'all') {
                    if (filter === 'sky' && u.tier !== 'sky') return;
                    if (filter === 'in_seoul_top' && u.tier !== 'in_seoul_top') return;
                    if (filter === 'in_seoul_mid' && u.tier !== 'in_seoul_mid') return;
                    if (filter === 'jigeoguk' && u.tier !== 'jigeoguk') return;
                }
                const diff = player.sat - u.jeongsi_cut;
                let badge = "";
                let badgeClass = "";
                if(diff >= 5) { badge = "ì•ˆì •"; badgeClass = "bg-green-100 text-green-700"; }
                else if(diff >= 0) { badge = "ì ì •"; badgeClass = "bg-blue-100 text-blue-700"; }
                else { badge = "ìƒí–¥"; badgeClass = "bg-red-100 text-red-700"; }

                const d = document.createElement('div');
                d.className = "university-card bg-white border border-slate-100 p-4 rounded-2xl flex justify-between items-center cursor-pointer transition-all";
                d.innerHTML = `
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-slate-50 rounded-full flex items-center justify-center text-xl ${u.color} shadow-sm border border-slate-100"><i class="${u.logo}"></i></div>
                        <div>
                            <div class="font-bold text-slate-800">${u.name}</div>
                            <div class="flex items-center gap-2 mt-1">
                                <span class="text-[10px] ${badgeClass} px-2 py-0.5 rounded-full font-bold">${badge}</span>
                                <span class="text-xs text-slate-400">ì»· ${u.jeongsi_cut}%</span>
                            </div>
                        </div>
                    </div>
                    <button onclick="addToJeongsiCart(${u.id})" class="w-9 h-9 rounded-full bg-indigo-50 text-indigo-600 hover:bg-indigo-600 hover:text-white flex items-center justify-center transition"><i class="fas fa-plus"></i></button>
                `;
                list.appendChild(d);
            });
        }

        window.addToJeongsiCart = (id) => {
            if(jeongsiCart.length >= 3) { alert("ì •ì‹œ ì›ì„œëŠ” ê°€/ë‚˜/ë‹¤êµ° 3ì¥ì…ë‹ˆë‹¤."); return; }
            if(jeongsiCart.find(x=>x.id===id)) { alert("ì´ë¯¸ ë‹´ì€ ëŒ€í•™ì…ë‹ˆë‹¤."); return; }
            jeongsiCart.push(universities.find(u=>u.id===id));
            updateJeongsiCart();
        };

        function updateJeongsiCart() {
            const list = document.getElementById('jeongsi-cart');
            const cnt = document.getElementById('jeongsi-count');
            const btn = document.getElementById('submit-jeongsi');
            cnt.innerText = jeongsiCart.length;
            updateStatus();
            list.innerHTML = '';
            
            if(jeongsiCart.length===0) {
                list.innerHTML = '<li class="text-center py-20 text-slate-400 text-sm flex flex-col items-center opacity-70"><i class="fas fa-clipboard-list text-4xl mb-3 text-slate-300"></i>ëŒ€í•™ì„ ì„ íƒí•˜ì„¸ìš”.</li>';
                btn.disabled = true; btn.className="w-full bg-slate-200 text-slate-400 font-bold py-4 rounded-2xl cursor-not-allowed shadow-none";
            } else {
                jeongsiCart.forEach((u, i) => {
                    const li = document.createElement('li');
                    li.className = "flex justify-between items-center p-3 bg-white border border-slate-100 rounded-xl text-sm pop-in shadow-sm";
                    li.innerHTML = `<span class="font-bold text-slate-700">${u.name}</span> <button onclick="jeongsiCart.splice(${i},1);updateJeongsiCart()" class="text-slate-300 hover:text-red-500 transition"><i class="fas fa-times"></i></button>`;
                    list.appendChild(li);
                });
                btn.disabled = false; btn.className="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-2xl shadow-lg active:scale-95 transition-all";
            }
        }

        document.getElementById('submit-jeongsi').onclick = () => {
            jeongsiCart.forEach(u => {
                const diff = player.sat - u.jeongsi_cut;
                let prob = 50 + diff*5;
                if(prob>95) prob=95; if(prob<5) prob=5;
                const passed = Math.random()*100 < prob;
                finalResults.push({name:u.name, type:'ì •ì‹œ', status:passed?'í•©ê²©':'ë¶ˆí•©ê²©'});
            });

            switchScene('scene-jeongsi-announce');
            const container = document.getElementById('jeongsi-results-container');
            container.innerHTML = '';
            
            setTimeout(() => {
                document.getElementById('jeongsi-loading').classList.add('hidden');
                container.classList.remove('opacity-0');
                finalResults.filter(r=>r.type==='ì •ì‹œ').forEach((r, i) => {
                    setTimeout(() => {
                        const d = document.createElement('div');
                        d.className = "bg-white border border-slate-100 p-5 rounded-2xl shadow-sm flex justify-between items-center pop-in";
                        d.innerHTML = `<span class="font-bold text-lg text-slate-800">${r.name}</span><span class="font-black text-xl ${r.status==='í•©ê²©'?'text-green-600':'text-slate-300'}">${r.status}</span>`;
                        container.appendChild(d);
                    }, i * 800);
                });
                setTimeout(() => {
                    document.getElementById('go-to-final-from-jeongsi').classList.remove('hidden');
                }, jeongsiCart.length * 800 + 500);
            }, 1500);
        };

        document.getElementById('go-to-final-from-jeongsi').onclick = showFinal;

        function showFinal() {
            switchScene('scene-final');
            document.querySelector('.final-name').innerText = player.name;
            document.querySelectorAll('.final-gpa-display').forEach(e=>e.innerText=player.gpa.toFixed(2));
            document.querySelectorAll('.final-sat-display').forEach(e=>e.innerText=player.sat);
            
            const list = document.getElementById('final-accepted-list');
            list.innerHTML = '';
            const passed = finalResults.filter(r=>r.status==='í•©ê²©');
            
            if(passed.length > 0) {
                passed.forEach(r => {
                    const d = document.createElement('div');
                    d.className = "bg-green-50 border border-green-200 p-4 rounded-xl flex justify-between items-center text-green-800 font-bold shadow-sm";
                    d.innerHTML = `<div class="flex items-center gap-2"><i class="fas fa-medal text-xl text-yellow-500"></i><span>${r.name}</span></div><span class="bg-white border border-green-200 text-green-700 text-xs px-3 py-1 rounded-full shadow-sm">${r.type}</span>`;
                    list.appendChild(d);
                });
            } else {
                list.innerHTML = `<div class="bg-slate-50 p-8 rounded-2xl text-slate-400 border border-dashed border-slate-300 text-sm"><i class="fas fa-cloud-rain text-4xl mb-3 block"></i>ì•„ì‰½ê²Œë„ í•©ê²©í•œ ëŒ€í•™ì´ ì—†ìŠµë‹ˆë‹¤.<br>ì¶”ê°€ëª¨ì§‘ ê¸°ê°„ì„ ë…¸ë ¤ë³´ì„¸ìš”!</div>`;
            }
        }
    </script>
</body>
</html>
